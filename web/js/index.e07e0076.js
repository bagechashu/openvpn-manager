import{au as j,av as C,an as L,aw as k,ax as f,ay as $,az as c,aA as n,aB as r,aC as y,F as b,aD as F,c as w,aE as U,r as x,B as h,aF as R,aG as d,aH as S,aI as A,aJ as G,aK as W}from"./chunks/vendor.e462bc93.js";import{N as q,a as J,b as K,c as I,d as X,e as N,f as H,g as Q,h as Y,i as Z,j as ee,k as te,u as se,l as ae,m as ne,n as re,o as P,p as oe}from"./chunks/navie-ui.5ad75a71.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const ie=""+new URL("../img/ovpnmgr.png",import.meta.url).href,_=j.create({baseURL:{}.VUE_APP_BASE_API,timeout:5e3});_.interceptors.request.use(e=>e,e=>(console.log(e),Promise.reject(e)));_.interceptors.response.use(e=>{const{status:s,data:a}=e;switch(s){case 209:window.$message.warning(a.response.msg,{duration:2e3})}return Promise.resolve(a)},e=>{const{status:s,data:a}=e.response;switch(s){case 401:case 403:window.$message.error("No Permission, Please Login!",{duration:2e3});break;default:window.$message.error(a.response.msg||e.message,{duration:2e3})}return Promise.reject(e)});function O(e){return _({url:"/api/vpn/info",method:"get",params:e})}const le=C("vpn",()=>{const e=L({});return{vpnInfo:e,getVpnInfo:async()=>{const a=await O();e.value=a}}});const ce={__name:"VpnInfo",setup(e){const s=le(),{vpnInfo:a}=k(s);return Object.keys(a.value).length===0&&O().then(u=>{s.vpnInfo.value=u}).catch(u=>{console.error("Error fetching VPN info:",u)}),(u,t)=>(f(),$(r(X),{bordered:""},{default:c(()=>[n(r(q),null,{default:c(()=>[(f(!0),y(b,null,F(r(a).value,(o,p,g)=>(f(),$(r(J),{key:g},{default:c(()=>[n(r(K),{cols:16,"item-responsive":""},{default:c(()=>[n(r(I),{class:"name",span:"0 500:3"},{default:c(()=>[w(U(p.toUpperCase()),1)]),_:2},1024),n(r(I),{class:"value",span:"16 500:13"},{default:c(()=>[w(U(o),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}};function V(e){return _({url:"/api/user/show",method:"get",params:e})}function ue(e){return _({url:"/api/user/add",method:"post",data:e})}function de(e){return _({url:`/api/user/revoke/${e}`,method:"delete"})}const pe=C("users",()=>{const e=L([]);return{users:e,getUsersList:async()=>{const t=await V();e.value=t},addUserLocal:t=>{e.value.unshift(t)},delUserLocal:t=>{let o=e.value.findIndex(p=>p.username===t);o!==-1&&e.value.splice(o,1)}}});const M=(e,s)=>{const a=e.__vccOpts||e;for(const[u,t]of s)a[u]=t;return a},E=e=>(S("data-v-36d567c9"),e=e(),A(),e),fe={class:"controlbar-wrapper"},me={class:"controlbar-left"},_e=E(()=>d("span",{style:{"margin-right":"5px"}},"Edit",-1)),ge={class:"controlbar-right"},ve=E(()=>d("div",null,"username",-1)),he={__name:"UserManager",setup(e){const s=pe(),{users:a}=k(s);Object.keys(a.value).length===0&&V().then(l=>{s.users.value=l.response.users}).catch(l=>{console.error("Error fetching users:",l)});const u={pageSize:10},t=x(!1),o=x([{title:"User",key:"username",align:"center",titleAlign:"center",minWidth:50},{title:"Manage",key:"manage",align:"center",titleAlign:"center",minWidth:200,render(l){return h("div",[h(N,{text:!0,size:"small",strong:!0,type:"primary",style:{display:t.value?"none":"inline-flex"},onClick:()=>{window.location.href=`/api/user/cert/${l.username}.ovpn`}},{default:()=>"Download Ovpn File",icon:()=>h(H,{color:"#000",size:24},{default:()=>h(R)})}),h(N,{strong:!0,size:"small",type:"error",style:{display:t.value?"inline-flex":"none"},onClick:()=>p(l)},{default:()=>"delete"})])}}]);function p(l){window.$dialog.warning({title:"Warning",content:`Are you sure to delete user [ ${l.username} ]?`,positiveText:"Sure",negativeText:"Cancel",style:"position: fixed; top: 11rem; left: 50%; transform: translateX(-50%)",onPositiveClick:()=>{de(l.username).then(i=>{console.log(i.response.msg),window.$message.success(`[ ${l.username} ] is deleted`,{duration:2e3}),s.delUserLocal(l.username)}).catch(i=>{window.$message.error(`Error while deleting users: ${i}`,{duration:2e3})})}})}const g=x(!1),v=x("");function D(){window.$message.warning("Canceled!")}function z(){const l=JSON.stringify({username:v.value});ue(l).then(i=>{console.log(i.response.msg,i.status),i.status==="success"&&(s.addUserLocal({username:v.value}),window.$message.success(`[${v.value}] creat success`,{duration:2e3}))}).catch(i=>{window.$message.error(`Error when creating users: ${i}`,{duration:2e3})})}return(l,i)=>(f(),y(b,null,[d("div",fe,[d("div",me,[_e,n(r(Q),{size:"small",value:t.value,"onUpdate:value":i[0]||(i[0]=m=>t.value=m)},null,8,["value"])]),d("div",ge,[n(r(N),{onClick:i[1]||(i[1]=m=>g.value=!0),size:"small",color:"#44aaee"},{default:c(()=>[w(" Create ")]),_:1})])]),n(r(Z),{show:g.value,"onUpdate:show":i[3]||(i[3]=m=>g.value=m),preset:"dialog",title:"create user","positive-text":"submit","negative-text":"cancel",style:{position:"fixed",top:"11rem",left:"50%",transform:"translateX(-50%)"},onPositiveClick:z,onNegativeClick:D},{default:c(()=>[d("div",null,[ve,n(r(Y),{value:v.value,"onUpdate:value":i[2]||(i[2]=m=>v.value=m),type:"text",placeholder:"eg: ovpn-20231212"},null,8,["value"])])]),_:1},8,["show"]),n(r(ee),{columns:o.value,bordered:!1,"single-line":!1,striped:!0,"scroll-x":300,data:r(s).users.value,pagination:u,"paginate-single-page":!1},null,8,["columns","data"]),n(r(te),{right:100})],64))}},we=M(he,[["__scopeId","data-v-36d567c9"]]),ye={__name:"MessageContainer",setup(e){return window.$message=se(),(s,a)=>(f(),y("div"))}},xe={__name:"DialogContainer",setup(e){return window.$dialog=ae(),(s,a)=>(f(),y("div"))}};const B=e=>(S("data-v-acb9af91"),e=e(),A(),e),Ne=B(()=>d("header",null,[d("img",{src:ie,style:{width:"40px",height:"40px",margin:"12px 10px 0 10px"}}),d("h2",{style:{"margin-top":"12px"}},"OpenVPN Manager")],-1)),be={class:"wrapper"},$e=B(()=>d("footer",null,[w("Â© Based on "),d("a",{href:"https://github.com/Nyr/openvpn-install"},"OpenVPN installation script"),w(" maintained by Nyr 2023")],-1)),Ue={__name:"App",setup(e){return(s,a)=>(f(),y(b,null,[Ne,n(r(ne),null,{default:c(()=>[n(ye)]),_:1}),n(r(re),null,{default:c(()=>[n(xe)]),_:1}),d("div",be,[n(r(oe),{type:"segment"},{default:c(()=>[n(r(P),{name:"vpn-info",tab:"VPN Info"},{default:c(()=>[n(ce)]),_:1}),n(r(P),{name:"user-manager",tab:"User Manager"},{default:c(()=>[n(we)]),_:1})]),_:1})]),$e],64))}},Ie=M(Ue,[["__scopeId","data-v-acb9af91"]]),T=G(Ie),Pe=W();T.use(Pe);T.mount("#app");
